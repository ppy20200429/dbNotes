```sql
select 
t1.id as id,
t1.bizid as bizid,
t1.zuid as zuid,
t1.droolszu as droolszu,
t1.drools_appid as drools_appid,
t2.drools_name as drools_name,
t2.describle as describle ,
t2.owner as owner
from
(
SELECT  a.id as id,
a.bizid as bizid ,
a.zuid as zuid,
a.droolszu as droolszu,
substring_index(substring_index(a.droolszu, ',', b.id),',' ,-1 ) as drools_appid
FROM pata_biz_zu_drools a  
JOIN  
(select 1 id union all select 2 union all select 3)  b
ON b.id<=(LENGTH(a.droolszu)-LENGTH(REPLACE (a.droolszu,',',''))+1)
where a.isactive=1 
) t1 
LEFT JOIN pata_drools t2
on t1.drools_appid=t2.drools_appid
order by id desc

```

1. 解析：
```sql
1)pata_biz_zu_drools表内容如下：

# id	bizid	zuid	droolszu	                   describle	isactive
11	  1005	202	  11001029,11001020,11001021		               1
12	  1012	101	  11001029,11001020,11001021		               1
13	  1012	202	  11001029,11001020,11001021		               1
14	  1012	12	  11001029,11001020,11001021		               1
15	  1012	14	  11001029,11001020,11001021		               1
16	  1012	306	  11001029,11001020,11001021		               1
17	  1012	308	  11001029,11001020,11001021		               1
18	  11001	101	  90001031,90001032,13001033		               1
19	  11001	202	  90001031,90001032,13001033		               1
20	  11001	103	  22001021,22001032,22001024		               1
21	  1001	101	  90001031,90001032,13001033		               1

2)pata_drools表内容如下：

# id	 drools_appid	drools_name	                  describle	                 owner	isactive
1	     30001026	    LoyalCustomerAuditSimplified	老客简版审批_new	          朱隽慧	1
2	     11001028	    PPKyiciAudit	                拍拍卡新客发标/跑批审批_new	张会君	1
3	     11001029	    PPKyiciClick	                拍拍卡新客戳额审批_new	      张会君	1
4	     11001020	    PPKyiciLimit	                拍拍卡新客戳额额度_new	      张会君	1
5	     11001021	    PPKyiciManager	              拍拍卡新客戳额调度_new	      张会君	1
6	     22001015	    MsiteFqscLimit	              分期商城新客额度_new	       张璐璐	1
7	     22001017	    MsiteFqscAudit	              分期商城新客审批_new	       张璐璐	1
8	     22001018	    MsiteFqscManager	            分期商城新客调度_new	       张璐璐	1
9	     90001006	    fqscAudit	                    分期商城审批new	             张璐璐	1

3)select 1 id union all select 2 union all select 3
# id
1
2
3

4)select LENGTH('11001029,11001020,11001021')-LENGTH(REPLACE ('11001029,11001020,11001021',',',''))+1; ==3  //droolszu的appid个数

  select substring_index('11001029,11001020,11001021', ',', 3);  =='11001029,11001020,11001021'

  select substring_index(substring_index('11001029,11001020,11001021', ',', 3),',' ,-1 );  =='11001021'

5)SELECT  a.id as id,
a.bizid as bizid ,
a.zuid as zuid,
a.droolszu as droolszu,
substring_index(substring_index(a.droolszu, ',', b.id),',' ,-1 ) as drools_appid
FROM pata_biz_zu_drools a  
JOIN  
(select 1 id union all select 2 union all select 3)  b
ON b.id<=(LENGTH(a.droolszu)-LENGTH(REPLACE (a.droolszu,',',''))+1)
where a.isactive=1  这部分SQL生成的表结构如下：

# id	bizid	zuid	droolszu	drools_appid
10	1005	101	11001029,11001020,11001021	11001029
10	1005	101	11001029,11001020,11001021	11001020
10	1005	101	11001029,11001020,11001021	11001021
11	1005	202	11001029,11001020,11001021	11001029
11	1005	202	11001029,11001020,11001021	11001020
11	1005	202	11001029,11001020,11001021	11001021
12	1012	101	11001029,11001020,11001021	11001029
12	1012	101	11001029,11001020,11001021	11001020
12	1012	101	11001029,11001020,11001021	11001021
13	1012	202	11001029,11001020,11001021	11001029
13	1012	202	11001029,11001020,11001021	11001020
13	1012	202	11001029,11001020,11001021	11001021
14	1012	12	11001029,11001020,11001021	11001029
14	1012	12	11001029,11001020,11001021	11001020
14	1012	12	11001029,11001020,11001021	11001021
15	1012	14	11001029,11001020,11001021	11001029
15	1012	14	11001029,11001020,11001021	11001020
15	1012	14	11001029,11001020,11001021	11001021
16	1012	306	11001029,11001020,11001021	11001029
16	1012	306	11001029,11001020,11001021	11001020
16	1012	306	11001029,11001020,11001021	11001021
17	1012	308	11001029,11001020,11001021	11001029
17	1012	308	11001029,11001020,11001021	11001020
17	1012	308	11001029,11001020,11001021	11001021
18	11001	101	90001031,90001032,13001033	90001031
18	11001	101	90001031,90001032,13001033	90001032
18	11001	101	90001031,90001032,13001033	13001033
19	11001	202	90001031,90001032,13001033	90001031
19	11001	202	90001031,90001032,13001033	90001032
19	11001	202	90001031,90001032,13001033	13001033
20	11001	103	22001021,22001032,22001024	22001021
20	11001	103	22001021,22001032,22001024	22001032
20	11001	103	22001021,22001032,22001024	22001024
21	1001	101	90001031,90001032,13001033	90001031
21	1001	101	90001031,90001032,13001033	90001032
21	1001	101	90001031,90001032,13001033	13001033
22	1001	12	10001007,14001003	10001007
22	1001	12	10001007,14001003	14001003
23	1001	306	10001007,14001003	10001007
23	1001	306	10001007,14001003	14001003


6)最终生成的表结构如下：

# id	bizid	zuid	droolszu	                 drools_appid	drools_name	        describle	owner
150	  1016	110	  24001004,24001005,24001003	24001005	  ScenePaymentLimit	  场景分期额度	王艳丽
150	  1016	110	  24001004,24001005,24001003	24001003	  ScenePaymentManager	场景分期调度	王艳丽
150	  1016	110	  24001004,24001005,24001003	24001004	  ScenePaymentAudit	  场景分期审批	王艳丽
149	  1016	105	  24001004,24001005,24001003	24001004	  ScenePaymentAudit	  场景分期审批	王艳丽
149	  1016	105	  24001004,24001005,24001003	24001005	  ScenePaymentLimit	  场景分期额度	王艳丽
149	  1016	105	  24001004,24001005,24001003	24001003	  ScenePaymentManager	场景分期调度	王艳丽
148	  1601	103	  10151006,10151005,10151007	10151007	  h5manage	          湖北消金调度	黄潇
148	  1601	103	  10151006,10151005,10151007	10151006	  h5audit	            湖北消金审批	黄潇
148	  1601	103	  10151006,10151005,10151007	10151005	  h5amount	          湖北消金调额	黄潇

```
